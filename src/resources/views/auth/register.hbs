{{!-- Register view --}}
<div class="auth-shell">
    <h2 class="h4">Create account</h2>

    {{#if error}}
        <div class="alert alert-danger">{{error}}</div>
    {{/if}}

    <form id="registerForm" action="/register" method="POST" class="form-auth">
        <input type="hidden" name="_csrf" value="{{csrfToken}}">
        <div class="form-group">
            <label for="name">Full name</label>
            <input id="name" name="name" type="text" class="form-control" required value="{{name}}">
        </div>

        <div class="form-group">
            <label for="email">Email</label>
            <input id="email" name="email" type="email" class="form-control" required value="{{email}}">
        </div>

        <div class="form-group">
            <label for="password">Password</label>
            <input id="password" name="password" type="password" class="form-control" required>
        </div>

        <div class="form-group">
            <label for="confirmPassword">Confirm password</label>
            <input id="confirmPassword" name="confirmPassword" type="password" class="form-control" required>
        </div>

        <div class="form-actions d-flex justify-content-between align-items-center">
            <button type="submit" class="btn btn-primary">Create account</button>
            <a href="/login" class="text-muted">Already have an account?</a>
        </div>
    </form>
</div>

<script>
    (function() {
        const form = document.getElementById('registerForm');
        if (!form) return;

        form.addEventListener('submit', function (e) {
            const pwd = form.querySelector('input[name="password"]').value || '';
            const cpwd = form.querySelector('input[name="confirmPassword"]').value || '';
            // Remove any existing client-side alert
            const existing = form.querySelector('.client-alert');
            if (existing) existing.remove();

            if (pwd !== cpwd) {
                e.preventDefault();
                const alert = document.createElement('div');
                alert.className = 'alert alert-danger client-alert';
                alert.textContent = 'Passwords do not match.';
                form.parentNode.insertBefore(alert, form);
                return false;
            }

            if (pwd.length < 6) {
                e.preventDefault();
                const alert = document.createElement('div');
                alert.className = 'alert alert-danger client-alert';
                alert.textContent = 'Password must be at least 6 characters.';
                form.parentNode.insertBefore(alert, form);
                return false;
            }
        });
    })();
</script>
